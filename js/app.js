// EDITA AQU√ç: tus items
// type: "image" | "video" | "pdf"
const ITEMS = [

  // ... COVISA ... //
  {
      type: "image",
      src: "media/img/cov_01.webp",
      thumb: "media/img/cov_01.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
    },
      
    {
      type: "image",
      src: "media/img/cov_03_f.webp",
      thumb: "media/img/cov_03.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
    },
    
    {
      type: "image",
      src: "media/img/cov_04_f.webp",
      thumb: "media/img/cov_04.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
    },
      
    {
      type: "image",
      src: "media/img/cov_07_f.webp",
      thumb: "media/img/cov_07.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
    },
      
    {
      type: "image",
      src: "media/img/cov_08.webp",
      thumb: "media/img/cov_08.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
    },
      
    {
      type: "image",
      src: "media/img/cov_10.webp",
      thumb: "media/img/cov_10.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
    },

 // ... PROSOUND ... //
    {
      type: "image",
      src: "media/img/pro_01.webp",
      thumb: "media/img/pro_01.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
    },
    
    {
     type: "video",
     src: "media/video/pro_02.mp4",
     thumb: "media/video/pro_02.mp4",
     title: "Demo ‚Äî Motion / Reel",
     tag: "Video",
     year: 2025,
     desc: ""
   },

   {
      type: "image",
      src: "media/img/pro_03_f.webp",
      thumb: "media/img/pro_03.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
   },

   {
      type: "image",
      src: "media/img/pro_04_f.webp",
      thumb: "media/img/pro_04.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
   },
    
    {
     type: "video",
     src: "media/video/pro_05.mp4",
     thumb: "media/video/pro_05.mp4",
     title: "Demo ‚Äî Motion / Reel",
     tag: "Video",
     year: 2025,
     desc: ""
   },

   {
      type: "image",
      src: "media/img/pro_06.webp",
      thumb: "media/img/pro_06.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
   },

  // ... FASE OLAVE ... //
      
    {
      type: "image",
      src: "media/img/fas_01.webp",
      thumb: "media/img/fas_01.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
    },
      
    {
      type: "image",
      src: "media/img/fas_02_f.webp",
      thumb: "media/img/fas_02.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
    },
      
    {
      type: "image",
      src: "media/img/fas_03_f.webp",
      thumb: "media/img/fas_03.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
    },
      
    {
     type: "video",
     src: "media/video/fas_04.mp4",
     thumb: "media/video/fas_04.mp4",
     title: "Demo ‚Äî Motion / Reel",
     tag: "Video",
     year: 2025,
     desc: ""
    },
     
    {
      type: "image",
      src: "media/img/fas_06.webp",
      thumb: "media/img/fas_06.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
    },
    
    {
     type: "video",
     src: "media/video/fas_05.mp4",
     thumb: "media/video/fas_05.mp4",
     title: "Demo ‚Äî Motion / Reel",
     tag: "Video",
     year: 2025,
     desc: ""
   },

  // ... RESET RESTO ... //
    
    {
      type: "image",
      src: "media/img/res_01.webp",
      thumb: "media/img/res_01.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
    },
    
    {
      type: "image",
      src: "media/img/res_02.webp",
      thumb: "media/img/res_02.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
    },
    
    {
      type: "image",
      src: "media/img/res_03_f.webp",
      thumb: "media/img/res_03.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
    },
    
    {
      type: "image",
      src: "media/img/res_04_f.webp",
      thumb: "media/img/res_04.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
    },
    
    {
     type: "video",
     src: "media/video/res_05.mp4",
     thumb: "media/video/res_05.mp4",
     title: "Demo ‚Äî Motion / Reel",
     tag: "Video",
     year: 2025,
     desc: ""
   },
    
    {
     type: "video",
     src: "media/video/res_06.mp4",
     thumb: "media/video/res_06.mp4",
     title: "Demo ‚Äî Motion / Reel",
     tag: "Video",
     year: 2025,
     desc: ""
   },

     // ... TRIANGL... //
    {
      type: "image",
      src: "media/img/tria_01.webp",
      thumb: "media/img/tria_01.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/tria_02.webp",
      thumb: "media/img/tria_02.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/tria_03.webp",
      thumb: "media/img/tria_03.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/tria_04.webp",
      thumb: "media/img/tria_04.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/tria_05_f.webp",
      thumb: "media/img/tria_05.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/tria_06_f.webp",
      thumb: "media/img/tria_06.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

  // ... FACTOR Q... //
    {
      type: "image",
      src: "media/img/fq_01.webp",
      thumb: "media/img/fq_01.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/fq_02_f.webp",
      thumb: "media/img/fq_02.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/fq_03.webp",
      thumb: "media/img/fq_03.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/fq_04_f.webp",
      thumb: "media/img/fq_04.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/fq_05.webp",
      thumb: "media/img/fq_05.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/fq_06.webp",
      thumb: "media/img/fq_06.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },
    // ... ICHN ... //
    {
      type: "image",
      src: "media/img/ich_01.webp",
      thumb: "media/img/ich_01.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/ich_02_f.webp",
      thumb: "media/img/ich_02.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/ich_03_f.webp",
      thumb: "media/img/ich_03.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/ich_04.webp",
      thumb: "media/img/ich_04.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/ich_05.webp",
      thumb: "media/img/ich_05.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/ich_06.webp",
      thumb: "media/img/ich_06.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

  // ... brand... //
    {
      type: "image",
      src: "media/img/brand_01.webp",
      thumb: "media/img/brand_01.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/brand_02.webp",
      thumb: "media/img/brand_02.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/brand_03.webp",
      thumb: "media/img/brand_03.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/brand_04.webp",
      thumb: "media/img/brand_04.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/brand_05.webp",
      thumb: "media/img/brand_05.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/brand_06.webp",
      thumb: "media/img/brand_06.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

    {
      type: "image",
      src: "media/img/brand_07.webp",
      thumb: "media/img/brand_07.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/brand_08.webp",
      thumb: "media/img/brand_08.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/brand_09.webp",
      thumb: "media/img/brand_09.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/brand_10.webp",
      thumb: "media/img/brand_10.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/brand_11.webp",
      thumb: "media/img/brand_11.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },

   {
      type: "image",
      src: "media/img/brand_12.webp",
      thumb: "media/img/brand_12.webp",
      title: "Proyecto 1 ‚Äî Branding",
      tag: "Branding",
      year: 2025,
      desc: "Breve descripci√≥n del proyecto."
  },
  // ... (deja tus otros items tal cual)
  // {
  //   type: "video",
  //   src: "media/demo.mp4",
  //   thumb: "media/demo.mp4",
  //   title: "Demo ‚Äî Motion / Reel",
  //   tag: "Video",
  //   year: 2025,
  //   desc: ""
  // },
  // {
  //   type: "pdf",
  //   src: "pdf/caso-estudio.pdf",
  //   thumb: null,
  //   title: "Caso de estudio ‚Äî PDF",
  //   tag: "PDF",
  //   year: 2024,
  //   desc: ""
  // }
];

const $grid = document.getElementById("portfolio");
const $modal = document.getElementById("modal");
const $viewer = document.getElementById("viewer");

const $lbClose = document.getElementById("lbClose");
const $lbPrev = document.getElementById("lbPrev");
const $lbNext = document.getElementById("lbNext");

let currentIndex = -1;

function escapeHtml(str){
  return String(str).replace(/[&<>"']/g, (m)=>({
    "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#039;"
  }[m]));
}

function render(){
  $grid.innerHTML = "";

  // Necesitamos idx para poder navegar en lightbox
  ITEMS.forEach((item, idx) => {
    const a = document.createElement("a");
    a.className = "tile";
    a.href = item.src;

    a.addEventListener("click", (e)=>{
      e.preventDefault();
      openModal(idx);
    });

    if(item.type === "image"){
      const img = document.createElement("img");
      img.loading = "lazy";
      img.alt = item.title || "Imagen";
      img.src = item.thumb || item.src;
      a.appendChild(img);

    } else if(item.type === "video"){
      const vid = document.createElement("video");
      vid.src = item.thumb || item.src;
      vid.muted = true;
      vid.playsInline = true;
      vid.loop = true;
      vid.autoplay = true;
      a.appendChild(vid);

    }
     else {
      const box = document.createElement("div");
      box.style.cssText = "height:100%; display:grid; place-items:center; padding:18px; text-align:center;";
      box.innerHTML = `
        <div style="max-width:80%;">
          <div style="font-size:40px; line-height:1; margin-bottom:10px;">üìÑ</div>
          <div style="font-weight:650; margin-bottom:6px;">${escapeHtml(item.title || "Documento")}</div>
          <div style="color:var(--muted); font-size:13px;">Abrir y descargar</div>
        </div>
      `;
      a.appendChild(box);
    }
    $grid.appendChild(a);
  });
}

function openModal(idx){
  // normaliza √≠ndice
  if(!Number.isInteger(idx) || idx < 0 || idx >= ITEMS.length) idx = 0;
  currentIndex = idx;

  const item = ITEMS[currentIndex];

  // IMPORTANTE: limpiar el viewer antes de cargar nuevo contenido
  $viewer.innerHTML = "";

  if(item.type === "image"){
    const img = document.createElement("img");
    img.alt = item.title || "Imagen";
    img.src = item.src;
    $viewer.appendChild(img);

    // opcional: click sobre la imagen para cerrar
    img.addEventListener("click", closeModal);

  } else if(item.type === "video"){
  const vid = document.createElement("video");
  vid.src = item.src;

  // ‚úÖ autoplay real en lightbox
  vid.muted = false;
  vid.loop = true;
  vid.autoplay = true;
  vid.playsInline = true;
  vid.preload = "auto";

  // si quieres controles, d√©jalos ON (no afecta autoplay si est√° muted)
  vid.controls = true;

  $viewer.appendChild(vid);

  // ‚úÖ forzar reproducci√≥n despu√©s de insertarlo
  requestAnimationFrame(() => {
    const p = vid.play();
    if (p && typeof p.catch === "function") p.catch(() => {});
  });
} 
  else if(item.type === "pdf"){
    const iframe = document.createElement("iframe");
    iframe.src = item.src;
    iframe.title = item.title || "PDF";
    iframe.loading = "lazy";
    $viewer.appendChild(iframe);
  }

  $modal.classList.add("open");
  document.body.style.overflow = "hidden";
}

function closeModal(){
  $modal.classList.remove("open");
  $viewer.innerHTML = "";
  document.body.style.overflow = "";
}

function showByIndex(nextIdx){
  if(ITEMS.length === 0) return;

  if(nextIdx < 0) nextIdx = ITEMS.length - 1;
  if(nextIdx >= ITEMS.length) nextIdx = 0;

  openModal(nextIdx);
}

// Botones
$lbClose.addEventListener("click", closeModal);
$lbPrev.addEventListener("click", ()=> showByIndex(currentIndex - 1));
$lbNext.addEventListener("click", ()=> showByIndex(currentIndex + 1));

// Click fuera del contenido cierra
$modal.addEventListener("click", (e)=>{
  if(e.target === $modal) closeModal();
});

// Teclado: ESC cierra, flechas navegan
window.addEventListener("keydown", (e)=>{
  if(!$modal.classList.contains("open")) return;

  if(e.key === "Escape") closeModal();
  if(e.key === "ArrowLeft") showByIndex(currentIndex - 1);
  if(e.key === "ArrowRight") showByIndex(currentIndex + 1);
});


// Inicial
render();
